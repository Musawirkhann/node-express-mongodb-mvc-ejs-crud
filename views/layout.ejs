<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>map</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.5.0/css/ol.css" type="text/css">
    <link rel="stylesheet" href="/css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <link rel="stylesheet" type="text/css" href="/css/owl.carousel.css">
    <link rel="stylesheet" type="text/css" href="/css/owl.theme.css">
    <link rel="stylesheet" type="text/css" href="/css/owl.transitions.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/leaflet.pm@latest/dist/leaflet.pm.css" />
    <link rel="stylesheet" href="https://leaflet.github.io/Leaflet.markercluster/dist/MarkerCluster.css" />
	  <link rel="stylesheet" href="https://leaflet.github.io/Leaflet.markercluster/dist/MarkerCluster.Default.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.3.0/dist/MarkerCluster.css"/>
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.3.0/dist/MarkerCluster.Default.css"/>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.0/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.3.0/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://maps-sdk.trimblemaps.com/v2/trimblemaps-2.3.1.css" />
        <script src="https://maps-sdk.trimblemaps.com/v2/trimblemaps-2.3.1.js"></script>
  </head>
  <header>
    <%- include('header'); %>
  
</header>
 
<body>
  <div class="collapse" id="searcharea">
    <!-- top search -->
    <div class="input-group">
        <input type="text" class="form-control" placeholder="Search for...">
        <span class="input-group-btn">
          <button class="btn btn-primary" type="button">Search</button>
      </span>
    </div>
  </div>
    <!-- /.top search -->
    <div class="top-bar">
      <div class="container">
          <div class="row">
              <div class="col-md-6 top-message">
                  <p>Welcome to SfaxCity</p>
              </div>
              <div class="col-md-6 top-links">
                  <ul class="listnone">
                      <li><a href="faq.html"> Help </a></li>
                      <li><a href="pricing-plan.html">Pricing</a></li>
                      <li><a href="signup-couple.html" class=" ">I m user</a></li>
                      <li><a href="signup-vendor.html">Are you admin?</a></li>
                      <li><a href="login-page.html">Log in</a></li>
                      <li>
                          <a role="button" data-toggle="collapse" href="#searcharea" aria-expanded="false" aria-controls="searcharea"> <i class="fa fa-search"></i> </a>
                      </li>
                  </ul>
              </div>
          </div>
      </div>
  </div>

<div class="slider-bg">
  <!-- slider start-->
  <div id="slider" class="owl-carousel owl-theme slider">
      <div class="item"><img src="images/sfax.jpg"></div>
      <div class="item"><img src="images/hero-image-2.jpg" alt="Wedding couple just married"></div>
      <div class="item"><img src="images/hero-image.jpg" alt="Wedding couple just married"></div>
  </div>
  <div class="find-section">
      <!-- Find search section-->
      <div class="container">
          <div class="row">
              <div class="col-md-offset-1 col-md-10 finder-block">
                  <div class="finder-caption">
                      <h1>We will help you to find all </h1>
                      <p><strong>Find great places , hotels , restourants , Markets, shops... </strong> </p>
                  </div>
                  <div class="finderform">
                      <form>
                          <div class="row">
                              <div class="form-group col-md-4">
                                  <select class="form-control">
                                      <option>Select Vendor Category</option>
                                      <option value="Venue">Venue</option>
                                      <option value="Photographer">Photographer</option>
                                      <option value="Cake">Cake</option>
                                      <option value="Dj">Dj</option>
                                      <option value="Florist">Florist</option>
                                      <option value="Videography">Videography</option>
                                      <option value="jewellery">Jewellery</option>
                                      <option value="Gifts">Gifts</option>
                                      <option value="Dresses">Dresses</option>
                                  </select>
                              </div>
                              <div class="form-group col-md-4">
                                  <select class="form-control">
                                      <option>Select City</option>
                                      <option value="Ahmedabad">Ahmedabad</option>
                                      <option value="Gandhinagar">Gandhinagar</option>
                                      <option value="Rajkot">Rajkot</option>
                                      <option value="Surat">Surat</option>
                                      <option value="Vadodara">Vadodara</option>
                                  </select>
                              </div>
                              <div class="form-group col-md-4">
                                  <button type="submit" class="btn btn-primary btn-lg btn-block">Find Vendors</button>
                              </div>
                          </div>
                      </form>
                  </div>
              </div>
          </div>
      </div>
  </div>
  <!-- /.Find search section-->
</div>
    <!-- slider end-->
    <div class="section-space80">
      <!-- Feature Blog Start -->
      <div class="container">
          <div class="row">
              <div class="col-md-12">
                  <div class="section-title mb60 text-center">
                      <h1>Your Wedding Planing Start Here</h1>
                      <p>Various versions have evolved over the years sometimes by accident sometimes on purpose.</p>
                  </div>
              </div>
          </div>
          <div class="row">
              <!-- feature center -->
              <div class="col-md-4">
                  <div class="feature-block feature-center">
                      <!-- feature block -->
                      <div class="feature-icon"><img src="images/vendor.svg" alt=""></div>
                      <h2>Find Shops & Markets</h2>
                      <p>Many desktop publishing packages and web page editors now use Lorem Ipsum as their default model text.</p>
                  </div>
              </div>
              <!-- /.feature block -->
              <div class="col-md-4">
                  <div class="feature-block feature-center">
                      <!-- feature block -->
                      <div class="feature-icon"><img src="images/mail.svg" alt=""></div>
                      <h2>Contact Post Office</h2>
                      <p>Various versions have evolved over the years, sometimes by accident, sometimes on purpose (injected humour and the like).</p>
                  </div>
              </div>
              <!-- /.feature block -->
              <div class="col-md-4">
                  <div class="feature-block feature-center">
                      <!-- feature block -->
                      <div class="feature-icon"><img src="images/library.png" style="width:22%;"alt=""></div>
                      <h2>Find Schools</h2>
                      <p>The generated Lorem Ipsum is therefore always free from repetition injected humour or non-characteristic words etc.</p>
                  </div>
              </div>
              <!-- /.feature block -->
          </div>
          <!-- /.feature center -->
      </div>
  </div>
  <div class="section-space80 bg-light">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="section-title mb60 text-center">
                    <h1>Featured Wedding Vendor</h1>
                    <p>Many desktop publishing packages and web page editors now use orem psum as their default model text.</p>
                </div>
            </div>
        </div>
        <div class="row ">
            <div class="col-md-4">
                <!-- vendor box start-->
                <div class="vendor-box">
                    <div class="vendor-image">
                        <!-- vendor pic -->
                        <a href="#"><img src="images/vendor-1.jpg" alt="wedding vendor" class="img-responsive"></a>
                        <div class="feature-label"></div>
                        <div class="favourite-bg"><a href="#" class=""><i class="fa fa-heart"></i></a></div>
                    </div>
                    <!-- /.vendor pic -->
                    <div class="vendor-detail">
                        <!-- vendor details -->
                        <div class="caption">
                            <!-- caption -->
                            <h2><a href="#" class="title">Venue Vendor Title</a></h2>
                            <p class="location"><i class="fa fa-map-marker"></i> Street Address, Name of Town, 12345, Country.</p>
                            <div class="rating"> <i class="fa fa-star"></i> <i class="fa fa-star"></i> <i class="fa fa-star"></i> <i class="fa fa-star"></i> <i class="fa fa-star-o"></i> <span class="rating-count">(2)</span> </div>
                        </div>
                        <!-- /.caption -->
                        <div class="vendor-price">
                            <div class="price">$190 - $600</div>
                        </div>
                    </div>
                    <!-- vendor details -->
                </div>
            </div>
            <!-- /.vendor box start-->
            <div class="col-md-4">
                <!-- vendor box start-->
                <div class="vendor-box">
                    <div class="vendor-image">
                        <!-- vendor pic -->
                        <a href="#"><img src="images/vendor-4.jpg" alt="wedding vendor" class="img-responsive"></a>
                        <div class="rated-label"></div>
                        <div class="favourite-bg"><a href="#" class=""><i class="fa fa-heart"></i></a></div>
                    </div>
                    <!-- /.vendor pic -->
                    <div class="vendor-detail">
                        <!-- vendor details -->
                        <div class="caption">
                            <!-- caption -->
                            <h2><a href="#" class="title"> Wedding Dress Vendor Title</a></h2>
                            <p class="location"><i class="fa fa-map-marker"></i> Street Address, Name of Town, 12345, Country.</p>
                            <div class="rating"> <i class="fa fa-star"></i> <i class="fa fa-star"></i> <i class="fa fa-star"></i> <i class="fa fa-star"></i> <i class="fa fa-star-o"></i> <span class="rating-count">(3)</span> </div>
                        </div>
                        <!-- /.caption -->
                        <div class="vendor-price">
                            <div class="price">$290 - $600</div>
                        </div>
                    </div>
                </div>
                <!-- vendor details -->
            </div>
            <!-- /.vendor box start-->
            <div class="col-md-4 vendor-box">
                <!-- vendor box start-->
                <div class="vendor-image">
                    <!-- vendor pic -->
                    <a href="#"><img src="images/vendor-3.jpg" alt="wedding vendor" class="img-responsive"></a>
                    <div class="popular-label"></div>
                    <div class="favourite-bg"><a href="#" class=""><i class="fa fa-heart"></i></a></div>
                </div>
                <!-- /.vendor pic -->
                <div class="vendor-detail">
                    <!-- vendor details -->
                    <div class="caption">
                        <!-- caption -->
                        <h2><a href="#" class="title">Vendor Photographer Title</a></h2>
                        <p class="location"><i class="fa fa-map-marker"></i> Street Address, Name of Town, 12345, Country.</p>
                        <div class="rating"> <i class="fa fa-star"></i> <i class="fa fa-star"></i> <i class="fa fa-star"></i> <i class="fa fa-star"></i> <i class="fa fa-star-o"></i> <span class="rating-count">(5)</span> </div>
                    </div>
                    <!-- /.caption -->
                    <div class="vendor-price">
                        <div class="price">$390 - $600</div>
                    </div>
                </div>
                <!-- vendor details -->
            </div>
        </div>
    </div>
</div>

<div class="section-space80">
  <!-- top location -->
  <div class="container">
      <div class="row">
          <div class="col-md-12">
              <div class="section-title mb60 text-center">
                  <h1>Top Wedding Locations</h1>
                  <p>Many desktop publishing packages and web page editors now use Lorem Ipsum as their default model text.</p>
              </div>
          </div>
      </div>
      <div class="row">
          <div class="col-md-4 location-block">
              <!-- location block -->
              <div class="vendor-image">
                  <a href="#"><img src="images/location-pic.jpg" alt="" class="img-responsive"></a> <a href="#" class="venue-lable"><span class="label label-default">New York City</span></a> </div>
          </div>
          <!-- /.location block -->
          <div class="col-md-4 location-block">
              <!-- location block -->
              <div class="vendor-image">
                  <a href="#"><img src="images/location-pic-2.jpg" alt="" class="img-responsive"></a> <a href="#" class="venue-lable"><span class="label label-default">Sydney</span></a> </div>
          </div>
          <!-- /.location block -->
          <div class="col-md-4 location-block">
              <!-- location block -->
              <div class="vendor-image">
                  <a href="#"><img src="images/location-pic-3.jpg" alt="" class="img-responsive"></a> <a href="#" class="venue-lable"><span class="label label-default">Russia</span></a> </div>
          </div>
          <!-- /.location block -->
          <div class="col-md-8 location-block">
              <!-- location block -->
              <div class="vendor-image">
                  <a href="#"><img src="images/location-pic-4.jpg" alt="" class="img-responsive"></a> <a href="#" class="venue-lable"><span class="label label-default">Germany</span></a> </div>
          </div>
          <!-- /.location block -->
          <div class="col-md-4 location-block">
              <!-- location block -->
              <div class="vendor-image">
                  <a href="#"><img src="images/location-pic-5.jpg" alt="" class="img-responsive"></a> <a href="#" class="venue-lable"><span class="label label-default">Paris</span></a> </div>
          </div>
          <!-- /.location block -->
      </div>
  </div>
</div>
<!-- /. Testimonial Section -->
<div class="section-space80">
  <!-- Call to action -->
  <div class="container">
      <div class="row">
          <div class="col-md-6 couple-block">
              <div class="couple-icon"><img src="images/couple.svg" alt=""></div>
              <h2>Are you couple find the venue ?</h2>
              <p>Various versions have evolved over the years, sometimes by accident, sometimes on purpose (injected humour and the like).</p>
              <a href="#" class="btn btn-primary">Find Vendor</a> </div>
          <div class="col-md-6 vendor-block">
              <div class="vendor-icon"><img src="images/vendor.svg" alt=""></div>
              <h2>Are you wedding vender ?</h2>
              <p>Fusce eget elementum quam, vel tempor justo. Ut imperdiet eget sapien dictum aliquam. Nulla maximus sodales dignissim.</p>
              <a href="#" class="btn btn-primary">Add Your Listing</a></div>
      </div>
  </div>
</div>
<!-- /. Call to action -->
<div class="footer">
  <!-- Footer -->
  <div class="container">
      <div class="row">
          <div class="col-md-5 ft-aboutus">
              <h2>Wedding.Vendor</h2>
              <p>At Wedding Vendor our purpose is to help people find great online network connecting wedding suppliers and wedding couples who use those suppliers. <a href="#">Start Find Vendor!</a></p>
              <a href="#" class="btn btn-default">Find a Vendor</a> </div>
          <div class="col-md-3 ft-link">
              <h2>Useful links</h2>
              <ul>
                  <li><a href="#">About Us</a></li>
                  <li><a href="#">Contact us</a></li>
                  <li><a href="#">News</a></li>
                  <li><a href="#">Career</a></li>
                  <li><a href="#">Privacy Policy</a></li>
                  <li><a href="#">Terms of Use</a></li>
              </ul>
          </div>
          <div class="col-md-4 newsletter">
              <h2>Subscribe for Newsletter</h2>
              <form>
                  <div class="input-group">
                      <input type="text" class="form-control" placeholder="Enter E-Mail Address" required>
                      <span class="input-group-btn">
      <button class="btn btn-default" type="button">Submit</button>
      </span> </div>
                  <!-- /input-group -->
                  <!-- /.col-lg-6 -->
              </form>
              <div class="social-icon">
                  <h2>Be Social &amp; Stay Connected</h2>
                  <ul>
                      <li><a href="#"><i class="fa fa-facebook-square"></i></a></li>
                      <li><a href="#"><i class="fa fa-twitter-square"></i></a></li>
                      <li><a href="#"><i class="fa fa-google-plus-square"></i></a></li>
                      <li><a href="#"><i class="fa fa-instagram"></i></a></li>
                      <li><a href="#"><i class="fa fa-flickr"></i></a></li>
                  </ul>
              </div>
          </div>
      </div>
  </div>
</div>

   
    <!--<a href="" class="btn btn-sm btn-danger" ><i class="fa fa-trash" onclick='supprimer()'></i></a>-->
      <!--<div id="map" style="width: 1500px; height: 600px">
        <div id="popup" class="ol-popup">
      
        </div>
          <a href="#" id="popup-closer" class="ol-popup-closer"></a>
          <div id="popup-content">
          
          </div>
      
      </div>-->
      
      <script src="https://unpkg.com/leaflet.pm@latest/dist/leaflet.pm.min.js"></script>
            <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
            <script src="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.5.0/build/ol.js"></script>
<!--<div class="modal fade" id="pointadding" tabindex="-1" role="dialog" aria-labelledby="pointaddingLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="pointaddingLabel">New Entry</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <form action="/addPost"  method="POST">
        <div class="col-6">
          <div class="form-group">
              <label class="col-form-label" for="numero">numero</label>
              <input type="number" class="form-control" name="numero"  placeholder="numero" id="numero">
          </div>
      </div>
            <div class="col-6">
              <div class="form-group">
                  <label class="col-form-label" for="type">Type</label>
                  <input type="text" class="form-control" name="type" placeholder="type" id="type">
              </div>
            </div>

            <div class="col-6">
              <div class="form-group"> 
                
                  <input type="text"  class="form-control" id="laltitude" name="laltitude" value=""> 
              </div>
            </div>
  
            <div class="col-6">
              <div class="form-group"> 
                
                  <input type="text"  class="form-control" id="longitude" name="longitude"  class="value"> 
              </div>
            </div>

            
           
         
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button itype="submt" class="btn btn-success">Submit</button>      </div>
      </form>
    </div>
  </div>
</div>-->
<div class="overlay-container"style="margin-top: -30% auto;width : 100%;background-color: rgb(243, 243, 243);padding: 1em;box-shadow: 0 15px 20px rgba(0, 0, 0, 0.3);border-radius: 5px;" >
  <span id="btnClose" class="btnClose" style=" margin-top :-10%;float: right;font-size:16pt;cursor: pointer;color:rgb(228, 56, 13);">&times;</span>
  <span class='overlay-text' id='a'></span>
  <br><br>
  <span class='overlay-text' id='b'></span>
</div>
<script type="text/javascript" language="Javascript">
//supprimer point 

// create map and add layers
const map = new ol.Map({
      target: 'map',
      layers: [
        new ol.layer.Tile({
          source: new ol.source.OSM()
        }),
        
      ],
      view: new ol.View({
      center:([1197816.006371,4138617.095339]),
        zoom: 12
      })
    });
var drawSource= new ol.source.Vector({})
/*var elt = document.getElementById('caseACocher');
        console.log(elt.checked)
        console.log(elt.value)
var eltv=elt.value;
function addLayer(eltv) {
    if (eltv == 'Post'){
         drawLayerPost.setVisible(true)
        drawLayerMarket.setVisible(false)
        drawLayerEcole.setVisible(false)
       
    }

}*/

$(window).on("load",function(){

    // get all
    jQuery.get("/getAllPosts",function(data){ 
      const features = []; 
      console.log(data);
      var colorpoint;
      for (i = 0; i < data.length; i++){
            console.log("hello",data[i]);
            
                features.push(new ol.Feature({
                     geometry: new ol.geom.Point([data[i].longitude, data[i].laltitude ])
                }));
            
            
            console.log(features);
            colorpoint=data[i].type;
      }
      const vectorSource = new ol.source.Vector({
      features
    });
     if (colorpoint=="post"){
       console.log("je suis post ")
      }
      else{
           console.log("je suis autre")
       }
    const vectorLayer = new ol.layer.Vector({
      source: vectorSource,
      style: new ol.style.Style({
          image: new ol.style.Circle({
            radius: 15,
            fill: new ol.style.Fill({color: 'yellow'})
          })
      })
    });
    map.addLayer(vectorLayer);
  
 
    
      
   })
            
})
//var typefilter=$(".CheckMarqueur:checked").val();
//var typefilter = document.querySelector('.CheckMarqueur:checked').value;

//var checkedValue = null; 
//var checkedValue = document.getElementById('CheckMarqueur1:checked').value;

  
function filterMap(event){
  //get post 
  var mylayer; 
  console.log(event)
  
     
    jQuery.get("/getAllPosts",function(data){
    var typefilter = event.target.defaultValue; 
    
    var colorfilter='red'
   
    if (typefilter=='Post'){
       colorfilter ='yellow' ;
    }
    else if (typefilter=='Market'){
      colorfilter ='red' ;
    }
    else if (typefilter=='Pharmacie'){
      colorfilter ='green' ;
    }
    else if (typefilter=='Ecole'){
      colorfilter ='blue' ;
    }
      const features = []; 
      for (i = 0; i < data.length; i++){
            if (data[i].type == typefilter){
                features.push(new ol.Feature({
                     geometry: new ol.geom.Point([data[i].longitude, data[i].laltitude ]),
                     name: data[i].numero,
                    population: 4000,
                    rainfall: 500

                }));
              
                  }

      }
      
      const vectorSource = new ol.source.Vector({
      features 
    });
    const vectorLayer = new ol.layer.Vector({
      source: vectorSource,
      style: new ol.style.Style({
          image: new ol.style.Circle({
            radius: 15,
            fill: new ol.style.Fill({color: colorfilter})
          })
      })
     
    });
    
    if ( event.target.checked) {
      
      map.addLayer(vectorLayer);    
  
    } else {
        
        map.removeLayer(vectorLayer);
        vectorLayer.setVisible(false);
    }
         
  })
  
  
}
 var typeSelect = document.getElementById('typepoint');
 var type = document.getElementById('type');
var draw = new ol.interaction.Draw({
            type : 'Point',
            source:drawSource,
            style: function(){
                  if (typeSelect.value == 'Post'){
                      return new ol.style.Style({
                              image :new ol.style.Circle({
                                  fill: new ol.style.Fill({
                                      color:'yellow'
                                  }),
                                  radius:7
                              })
                          })
                  } 
              else if (typeSelect.value == 'Market'  ){
                
                  return new ol.style.Style({
                      image :new ol.style.Circle({
                          fill: new ol.style.Fill({
                              color:'red'
                          }),
                          
                          radius:7
                      })
                  })
                }  
                else if (typeSelect.value == 'Ecole'  ){
                  return new ol.style.Style({
                      image :new ol.style.Circle({
                          fill: new ol.style.Fill({
                              color:'blue'
                          }),
                          radius:7
                      })
                  })
                
              } 
              else {
                  return new ol.style.Style({
                      image :new ol.style.Circle({
                          fill: new ol.style.Fill({
                              color:'green'
                          }),
                          radius:7
                      })
                  }) 
              }
          }
      
    })
    
 function getType(){

  var x = document.getElementById("typepoint").value;
  console.log("typepoint",x);
  if (x == 'Post'){
    
    colordraw ='green' ;
    console.log('mycolor is green')
 }
  else if (x == 'Market'){
   colordraw ='red' ;
   console.log('mycolor is red');
 }
 var drawLayerPost = new ol.layer.Vector({
   source:drawSource,
   style: function(){
         return new ol.style.Style({
                 image :new ol.style.Circle({
                     fill: new ol.style.Fill({
                         color:colordraw
                     }),
                     radius:7
                 })
             })  
  } 
 });
 map.addLayer(drawLayerPost);
 
  }
  //vector Feature popup Logic
  const overlayContainerElement=document.querySelector('.overlay-container');
     const overlayLayer=new ol.Overlay({
       element:overlayContainerElement
     })
     map.addOverlay(overlayLayer);
     const overlayerA= document.getElementById('a');
     const overlayerB= document.getElementById('b');
     map.on ('click',function(e){
       overlayLayer.setPosition(undefined);
     map.forEachFeatureAtPixel(e.pixel,function(feature,layer){
      overlayContainerElement.style.display ='block';
       console.log(feature);
       let c= e.coordinate
       let a=e.coordinate[0];
       let b=e.coordinate[1];
       console.log(a,b);
       overlayLayer.setPosition(c);
       overlayerA.innerHTML= a;
       overlayerA.innerHTML= b;
     })
   }) 
   var btnClose = document.getElementById('btnClose');
   btnClose.addEventListener('click',closeModal);
   function closeModal() {
    overlayContainerElement.style.display ='none';
    }     




  /*let popup;
                // Listen for clicks on the truck stops layer
                map.on('click', function (evt) {
                    const popupLocation = evt.features[0].geometry.coordinates.slice([1197816.006371,4138617.095339]);
                    const popupContent = `Name: <br />
                        ID: <br />
                        Set: `;

                    popup = new ol.Popup()
                        .setLngLat(popupLocation)
                        .setHTML(popupContent)
                        .addTo(map);
                });*/
   
   /*var popup = new ol.Overlay({
    element: document.getElementById('popup'),
    });
    map.addOverlay(popup);
    map.on('click', function(evt) {
    var prettyCoord = ol.coordinate.toStringHDMS(ol.proj.transform(evt.coordinate, 'EPSG:3857', 'EPSG:4326'), 2);
    popup.show(evt.coordinate, '<div><h2>Coordinates</h2><p>' + prettyCoord + '</p></div>');
});*/


   /* map.on('singleclick', function(evt) {
    popup.hide();
    popup.setOffset([0, 0]);

    // Attempt to find a feature in one of the visible vector layers
    var feature = map.forEachFeatureAtPixel(evt.pixel, function(feature, layer) {
    return feature;
    });
    if (feature) {
        var coord = feature.getGeometry().getCoordinates();
        var props = feature.getProperties();
        var info =  "<input type='button' id='popup' value='Get here ?' />" ;
        // Offset the popup so it points at the middle of the marker n
        popup.setOffset([0, -22]);
          popup.show(coord, info);
          }   
        });
        $(document).on("click", "#popup", function(){
        alert(nearest_feature(my_position)); 
       });*/



   longitude = document.getElementById('longitude');
   latElem = document.getElementById('laltitude');
   longitude.value = '1197816.006371'; 
   latElem.value = '4138617.095339';
  //console.log(longitude);
  //console.log(latElem);
  
  draw.on('drawend',function(evt){
     
      // alert('point is added')
      clickedCoord = evt.feature.getGeometry().getFlatCoordinates() 
      //$('#pointadding').modal('show');
      console.log('clicked at', evt.feature.getGeometry().getFlatCoordinates()    )
      /*map.removeInteraction(draw)*/
       //console.log(draw.type)
         // let lat = clickedCoord[0];
          //let lng = clickedCoord[1];
        console.log(clickedCoord[0]);
        console.log(clickedCoord[1]);
        // Update the values in the panel
       
        longitude.value = clickedCoord[0];
        latElem.value = clickedCoord[1];
        type.value=typeSelect.value;
        //console.log(type.value);
        
        const requestOptions = {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({  numero:5,
                   type:typeSelect.value,
                   laltitude: clickedCoord[1].toString(),
                   longitude:  clickedCoord[0].toString()
                  
                  })
        };
        console.log(requestOptions.body);
        fetch('/addPost', requestOptions)
        .then(response => response.json());

      
  })
  
  // Function that enables draw interaction
  function startDrawing(){
  // add interaction to the map
    map.addInteraction(draw)
   }
  
  </script>        
             
<script
src="https://code.jquery.com/jquery-3.5.0.js"
integrity="sha256-r/AaFHrszJtwpe+tHyNi/XCfMxYpbsRg2Uqn0x3s2zc="
crossorigin="anonymous"></script>
     
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
 
<!-- Openlayers -->
<link rel="stylesheet" href="https://openlayers.org/en/latest/css/ol.css" />
<script type="text/javascript" src="https://openlayers.org/en/latest/build/ol.js"></script>
<script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=requestAnimationFrame,Element.prototype.classList,URL,Object.assign"></script>

<!-- ol-ext -->
<link rel="stylesheet" href="https://cdn.rawgit.com/Viglino/ol-ext/master/dist/ol-ext.min.css" />
<script type="text/javascript" src="https://cdn.rawgit.com/Viglino/ol-ext/master/dist/ol-ext.min.js"></script>
<!-- Openlayers -->
<link rel="stylesheet" href="https://openlayers.org/en/latest/css/ol.css" />
<script type="text/javascript" src="https://openlayers.org/en/latest/build/ol.js"></script>
<script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=requestAnimationFrame,Element.prototype.classList,URL,Object.assign"></script>

<!-- ol-ext -->
<link rel="stylesheet" href="https://cdn.rawgit.com/Viglino/ol-ext/master/dist/ol-ext.min.css" />
<script type="text/javascript" src="https://cdn.rawgit.com/Viglino/ol-ext/master/dist/ol-ext.min.js"></script>
<!--<script src="ol-popup.js"></script>-->   
</body>


</html>